import streamlit as st
import pandas as pd
import plotly.express as px

# Carregar dados
def carregar_dados():
    file_path = "Pasta2.xlsx"  # Substituir pelo caminho correto
    df = pd.read_excel(file_path, sheet_name="Banco de Dados")
    return df

df = carregar_dados()

# Layout do Streamlit
st.title("üìä Dashboard Financeiro - XPTO")

# Filtros
definicao_tipo = st.selectbox("Selecione o tipo de lan√ßamento", ["REALIZADO", "OR√áADO"], index=0)
mes_selecionado = st.selectbox("Selecione o m√™s", sorted(df["M√äS"].unique()))

df_filtrado = df[(df["TIPO DE LAN√áAMENTO"] == definicao_tipo) & (df["M√äS"] == mes_selecionado)]

# KPI
valor_total = df_filtrado["Valor"].sum()
st.metric(label="Total de Despesas", value=f"R$ {valor_total:,.2f}")

# Gr√°ficos
fig = px.bar(df_filtrado, x="CONTA CONT√ÅBIL", y="Valor", color="DEPARTAMENTO", title="Despesas por Conta Cont√°bil")
st.plotly_chart(fig)

# Tabela detalhada
st.dataframe(df_filtrado)
